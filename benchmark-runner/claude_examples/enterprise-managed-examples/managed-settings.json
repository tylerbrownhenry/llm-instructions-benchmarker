{
  "managedBy": "IT Security Policy v2.1",
  "lastUpdated": "2024-01-15T10:00:00Z",
  "policyVersion": "2.1.0",
  
  "permissions": {
    "allowTools": ["Read", "Write", "Edit", "Bash", "Glob", "Grep"],
    "denyTools": ["WebFetch", "WebSearch"],
    "requireApproval": [
      "Bash:rm -rf",
      "Bash:sudo", 
      "Bash:curl",
      "Bash:wget",
      "Bash:docker",
      "Bash:kubectl",
      "Write:/etc/*",
      "Write:/var/*",
      "Write:/usr/*"
    ],
    "blockedCommands": [
      "ssh",
      "scp",
      "rsync",
      "nc",
      "telnet"
    ]
  },
  
  "security": {
    "requireApiKeyFromVault": true,
    "vaultPath": "/secret/claude-code/api-keys",
    "maxSessionDuration": 7200,
    "forceReauthentication": 3600,
    "auditLogging": {
      "enabled": true,
      "logLevel": "detailed",
      "destinations": [
        "syslog://security-logs.company.com:514",
        "file:///var/log/claude-code/audit.log"
      ]
    },
    "encryptTranscripts": true,
    "retentionPolicy": {
      "transcripts": 90,
      "auditLogs": 2555
    }
  },
  
  "compliance": {
    "standards": ["SOX", "GDPR", "HIPAA"],
    "dataClassification": "confidential",
    "geographicRestrictions": ["US", "EU"],
    "allowedNetworks": [
      "10.0.0.0/8",
      "172.16.0.0/12", 
      "192.168.0.0/16"
    ],
    "blockedDomains": [
      "pastebin.com",
      "github.gist.com",
      "jsbin.com"
    ]
  },
  
  "agents": {
    "allowCustomAgents": false,
    "approvedAgents": [
      {
        "name": "enterprise-dev",
        "description": "Enterprise development assistant",
        "instructions": "Follow company coding standards. Never expose sensitive data. Use approved libraries only.",
        "maxConcurrency": 2,
        "auditLevel": "high"
      },
      {
        "name": "security-auditor",
        "description": "Security compliance assistant",
        "instructions": "Focus on security compliance and vulnerability assessment. Report all security findings.",
        "maxConcurrency": 1,
        "auditLevel": "maximum",
        "restrictedToRoles": ["security-team", "compliance-officer"]
      }
    ]
  },
  
  "hooks": {
    "mandatory": [
      {
        "event": "PreToolUse",
        "matcher": "*",
        "command": "logger -t claude-code \"User $USER executing: $CLAUDE_TOOL_INPUT_COMMAND\""
      },
      {
        "event": "PostToolUse",
        "matcher": "Write|Edit",
        "command": "/opt/company/bin/security-scan \"$CLAUDE_TOOL_INPUT_FILE_PATH\""
      },
      {
        "event": "Stop",
        "matcher": "*",
        "command": "/opt/company/bin/session-audit $USER $SESSION_ID"
      }
    ],
    "disallowOverride": true
  },
  
  "monitoring": {
    "telemetryLevel": "full",
    "metricsEndpoint": "https://metrics.company.com/claude-code",
    "alerting": {
      "securityViolations": "immediate",
      "policyViolations": "immediate",
      "unusualActivity": "hourly",
      "recipients": [
        "security-team@company.com",
        "it-admin@company.com"
      ]
    },
    "resourceLimits": {
      "maxMemoryMB": 2048,
      "maxCpuPercent": 50,
      "maxDiskSpaceMB": 1024,
      "maxNetworkBandwidthMbps": 10
    }
  },
  
  "environment": {
    "allowEnvironmentOverrides": false,
    "mandatoryVariables": {
      "COMPANY_PROXY": "http://proxy.company.com:8080",
      "COMPANY_PKI_CERT": "/etc/ssl/company-ca.crt",
      "SIEM_ENDPOINT": "https://siem.company.com/events"
    },
    "blockedVariables": [
      "ANTHROPIC_API_KEY",
      "OPENAI_API_KEY", 
      "AWS_ACCESS_KEY_ID",
      "AWS_SECRET_ACCESS_KEY"
    ]
  },
  
  "integration": {
    "sso": {
      "provider": "okta",
      "domain": "company.okta.com",
      "requiredGroups": ["claude-code-users"],
      "mfaRequired": true
    },
    "vault": {
      "provider": "hashicorp-vault",
      "endpoint": "https://vault.company.com",
      "authMethod": "ldap"
    },
    "logging": {
      "splunk": {
        "endpoint": "https://splunk.company.com:8088",
        "index": "claude-code-activity"
      }
    }
  },
  
  "updates": {
    "autoUpdate": false,
    "approvedVersions": ["1.2.0", "1.2.1"],
    "updateSource": "https://releases.company.com/claude-code",
    "verifySignatures": true
  },
  
  "support": {
    "helpdesk": "it-help@company.com",
    "documentation": "https://wiki.company.com/claude-code",
    "escalation": {
      "security": "security-team@company.com",
      "compliance": "compliance@company.com"
    }
  }
}